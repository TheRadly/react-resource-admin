{"version":3,"file":"useResourceInputsQueryForm.js","names":["_react","require","_typenameIdFilter","_interopRequireDefault","_useForm","obj","__esModule","default","useResourceInputsQueryForm","_ref","extraFormCruds","item","handleCloseQueryContainer","filterItems","saveLabel","createLabel","createQuery","updateQuery","id","useMemo","handleSubmit","setFieldValue","formValues","formHandler","useForm","initialValues","typenameIdFilter","onSubmitMethod","val","onSubmitInputs","createValue","loading","createLoading","updateValue","updateLoading","useEffect","filteredBalance","setValues","useCallback","variables","input","update","parsedValues","Object","keys","map","field","value","arrayOfValues","pv","find","handleChangeField","submitLocale","_default","exports"],"sources":["../../../../src/resources/ResourceInputsForm/talons/useResourceInputsQueryForm.ts"],"sourcesContent":["import { useCallback, useEffect, useMemo } from \"react\";\nimport type { CrudType } from \"../models/CrudType\";\nimport { FieldsType } from \"../models/FieldsType\";\nimport typenameIdFilter from \"../../../utils/typenameIdFilter\";\nimport useForm from \"../../ResourceForm/talons/useForm\";\n\ninterface UseResourceInputsQueryForm {\n  extraFormCruds: CrudType;\n  item?: any;\n  handleCloseQueryContainer?: () => void;\n  filterItems?: FieldsType[];\n  saveLabel?: string;\n  createLabel?: string;\n}\n\nconst useResourceInputsQueryForm = ({\n  extraFormCruds,\n  item,\n  handleCloseQueryContainer,\n  filterItems,\n  saveLabel,\n  createLabel,\n}: UseResourceInputsQueryForm) => {\n  const { createQuery, updateQuery, id } = useMemo(\n    () => extraFormCruds || {},\n    [extraFormCruds]\n  );\n\n  const { handleSubmit, setFieldValue, formValues, formHandler } = useForm({\n    initialValues: typenameIdFilter({ ...item }),\n    onSubmitMethod: (val: any) => onSubmitInputs(val),\n  });\n\n  const [createValue, { loading: createLoading }] = createQuery();\n  const [updateValue, { loading: updateLoading }] = updateQuery();\n\n  useEffect(() => {\n    if (item) {\n      const filteredBalance = typenameIdFilter({ ...item });\n      formHandler.setValues(filteredBalance, false);\n    }\n  }, [formHandler, item]);\n\n  const onSubmitInputs = useCallback(\n    (val: any) => {\n      if (item) {\n        updateValue({\n          variables: {\n            input: {\n              id,\n              update: {\n                ...val,\n              },\n            },\n          },\n        });\n      } else {\n        createValue({\n          variables: {\n            input: val,\n          },\n        });\n      }\n\n      if (handleCloseQueryContainer) {\n        handleCloseQueryContainer();\n      }\n    },\n    [updateValue, createValue, item, id, handleCloseQueryContainer]\n  );\n\n  const parsedValues = useMemo(\n    () =>\n      Object.keys(formValues).map((field) => ({\n        field,\n        value: formValues[field],\n      })),\n    [formValues]\n  );\n\n  const arrayOfValues = useMemo(\n    () =>\n      parsedValues.map((pv) => {\n        const item = filterItems?.find((item) => item.field === pv.field);\n\n        if (item) {\n          return {\n            ...pv,\n            ...item,\n          };\n        }\n\n        return pv;\n      }),\n    [filterItems, parsedValues]\n  ) as FieldsType[];\n\n  const handleChangeField = useCallback(\n    (value: string | number | boolean, field: string) => {\n      setFieldValue(field, value);\n    },\n    [setFieldValue]\n  );\n\n  const submitLocale = useMemo(\n    () => (item ? saveLabel : createLabel),\n    [item, saveLabel, createLabel]\n  );\n\n  return {\n    loading: createLoading || updateLoading,\n    handleSubmit,\n    arrayOfValues,\n    handleChangeField,\n    submitLocale,\n  };\n};\n\nexport default useResourceInputsQueryForm;\n"],"mappings":"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"}