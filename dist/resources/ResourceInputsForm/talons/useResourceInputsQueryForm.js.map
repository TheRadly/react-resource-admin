{"version":3,"file":"useResourceInputsQueryForm.js","names":["_react","require","_useForm","_interopRequireDefault","obj","__esModule","default","useResourceInputsQueryForm","_ref","extraFormCruds","item","handleCloseQueryContainer","filterItems","initialValues","createQuery","updateQuery","id","loading","saveLabel","createLabel","useMemo","createValue","createLoading","updateValue","updateLoading","onSubmitInputs","useCallback","val","variables","input","update","formOptions","valuesForEdit","onSubmitMethod","handleSubmit","setFieldValue","formValues","useForm","parsedValues","Object","keys","map","field","value","arrayOfValues","pv","find","handleChangeField","submitLocale","_default","exports"],"sources":["../../../../src/resources/ResourceInputsForm/talons/useResourceInputsQueryForm.ts"],"sourcesContent":["import { useCallback, useMemo } from \"react\";\nimport type { CrudType } from \"../models/CrudType\";\nimport { FieldsType } from \"../models/FieldsType\";\nimport useForm from \"../../ResourceForm/talons/useForm\";\n\ninterface UseResourceInputsQueryForm {\n  extraFormCruds: CrudType;\n  item?: any;\n  handleCloseQueryContainer?: () => void;\n  filterItems?: FieldsType[];\n}\n\nconst useResourceInputsQueryForm = ({\n  extraFormCruds,\n  item,\n  handleCloseQueryContainer,\n  filterItems,\n}: UseResourceInputsQueryForm) => {\n  const {\n    initialValues,\n    createQuery,\n    updateQuery,\n    id,\n    loading,\n    saveLabel,\n    createLabel,\n  } = useMemo(() => extraFormCruds || {}, [extraFormCruds]);\n\n  const [createValue, { loading: createLoading }] = createQuery();\n  const [updateValue, { loading: updateLoading }] = updateQuery();\n\n  const onSubmitInputs = useCallback(\n    (val: any) => {\n      if (item) {\n        updateValue({\n          variables: {\n            input: {\n              id,\n              update: {\n                ...val,\n              },\n            },\n          },\n        });\n      } else {\n        createValue({\n          variables: {\n            input: val,\n          },\n        });\n      }\n\n      if (handleCloseQueryContainer) {\n        handleCloseQueryContainer();\n      }\n    },\n    [updateValue, createValue, item, id, handleCloseQueryContainer]\n  );\n\n  const formOptions = useMemo(\n    () =>\n      item\n        ? {\n            valuesForEdit: item,\n            onSubmitMethod: onSubmitInputs,\n            loading,\n          }\n        : {\n            initialValues,\n            onSubmitMethod: onSubmitInputs,\n          },\n    [initialValues, item, loading, onSubmitInputs]\n  );\n\n  const { handleSubmit, setFieldValue, formValues } = useForm(formOptions);\n\n  const parsedValues = useMemo(\n    () =>\n      Object.keys(formValues).map((field) => ({\n        field,\n        value: formValues[field],\n      })),\n    [formValues]\n  );\n\n  const arrayOfValues = useMemo(\n    () =>\n      parsedValues.map((pv) => {\n        const item = filterItems?.find((item) => item.field === pv.field);\n\n        if (item) {\n          return {\n            ...pv,\n            ...item,\n          };\n        }\n\n        return pv;\n      }),\n    [filterItems, parsedValues]\n  ) as FieldsType[];\n\n  const handleChangeField = useCallback(\n    (value: string | number | boolean, field: string) => {\n      setFieldValue(field, value);\n    },\n    [setFieldValue]\n  );\n\n  const submitLocale = useMemo(\n    () => (item ? saveLabel : createLabel),\n    [item, saveLabel, createLabel]\n  );\n\n  return {\n    loading: createLoading || updateLoading,\n    handleSubmit,\n    arrayOfValues,\n    handleChangeField,\n    submitLocale,\n  };\n};\n\nexport default useResourceInputsQueryForm;\n"],"mappings":"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"}