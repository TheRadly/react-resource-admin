{"version":3,"file":"useResourceTableSearch.js","names":["_react","require","_config","_lodash","NONE","useResourceTableSearch","_ref","handleChangeTableSearch","fields","propFields","getQueryMethod","excludedSearchFields","isChecked","setChecked","useState","selectedField","setSelectedField","savedFields","setSavedFields","useMemo","filter","_ref2","field","includes","onChangeSearch","useCallback","_ref3","target","value","code","search","byField","onChangeSwitch","switchValue","onSelectDropdownField","_ref4","BOOLEAN_VALUES","dropdownFields","name","map","_ref5","capitalize","useEffect","length","_default","exports","default"],"sources":["../../../../src/resources/ResourceTableSearch/talons/useResourceTableSearch.ts"],"sourcesContent":["import { useCallback, useEffect, useMemo, useState } from \"react\";\nimport type { TableSearchArgument } from \"../models/TableSearchArgument\";\nimport { DropdownChangeEvent } from \"primereact/dropdown\";\nimport type { InputEventType } from \"../../../types/InputEventTypes\";\nimport { DropdownField } from \"../models/DropdownField\";\nimport { BOOLEAN_VALUES } from \"../config\";\nimport { capitalize } from \"lodash\";\n\nconst NONE = \"none\";\n\ninterface UseResourceTableSearchProps {\n  handleChangeTableSearch?: (arg: TableSearchArgument) => void;\n  fields: { field: string; sortable?: boolean }[];\n  getQueryMethod?: any;\n  excludedSearchFields?: string[];\n}\n\nconst useResourceTableSearch = ({\n  handleChangeTableSearch,\n  fields: propFields,\n  getQueryMethod,\n  excludedSearchFields,\n}: UseResourceTableSearchProps) => {\n  const [isChecked, setChecked] = useState<boolean>(false);\n  const [selectedField, setSelectedField] = useState<DropdownField | null>(\n    null\n  );\n\n  const [savedFields, setSavedFields] = useState<any>(null);\n\n  const fields = useMemo(\n    () =>\n      excludedSearchFields\n        ? propFields.filter(\n            ({ field }) => !excludedSearchFields.includes(field)\n          )\n        : propFields,\n    [excludedSearchFields, propFields]\n  );\n\n  const onChangeSearch = useCallback(\n    ({ target: { value } }: InputEventType) => {\n      if (\n        handleChangeTableSearch &&\n        selectedField &&\n        selectedField.code !== NONE\n      ) {\n        handleChangeTableSearch({\n          search: value,\n          byField: selectedField.code,\n        });\n      }\n    },\n    [selectedField, handleChangeTableSearch]\n  );\n\n  const onChangeSwitch = useCallback(\n    (switchValue: boolean) => {\n      setChecked(switchValue);\n      if (handleChangeTableSearch && selectedField) {\n        handleChangeTableSearch({\n          search: switchValue,\n          byField: selectedField.code,\n        });\n      }\n    },\n    [selectedField, setChecked, handleChangeTableSearch]\n  );\n\n  const onSelectDropdownField = useCallback(\n    ({ value }: DropdownChangeEvent) => {\n      setSelectedField(value);\n\n      if (value.code === NONE && getQueryMethod) {\n        getQueryMethod();\n      }\n\n      if (BOOLEAN_VALUES.includes(value.code) && handleChangeTableSearch) {\n        handleChangeTableSearch({\n          search: false,\n          byField: value.code,\n        });\n      }\n    },\n    [handleChangeTableSearch, getQueryMethod, setSelectedField]\n  );\n\n  const dropdownFields = useMemo(\n    () => [\n      { name: \"None\", code: NONE },\n      ...fields.map(({ field }) => ({\n        name: capitalize(field),\n        code: field,\n      })),\n    ],\n    [fields]\n  ) as DropdownField[];\n\n  useEffect(() => {\n    if (dropdownFields && dropdownFields.length > 1) {\n      setSavedFields(dropdownFields);\n    }\n  }, [dropdownFields, setSavedFields]);\n\n  useEffect(() => {\n    return () => getQueryMethod();\n  }, []);\n\n  return {\n    isChecked,\n    onChangeSwitch,\n    onChangeSearch,\n    onSelectDropdownField,\n    selectedField,\n    dropdownFields: dropdownFields.length > 1 ? dropdownFields : savedFields,\n  };\n};\n\nexport default useResourceTableSearch;\n"],"mappings":"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"}