{"version":3,"file":"useResourceTableContainer.js","names":["_react","require","_lodash","_interopRequireDefault","_staticTexts","obj","__esModule","default","useResourceTableContainer","_ref","getQueryMethod","deleteQueryMethod","order","setOrder","useState","ASC_SORT","selectedValues","setSelectedValues","isSelectable","setSelectable","isEditable","setEditable","isDeleteClicked","setDeleteClicked","debouncedGetSearchValue","_","debounce","_ref2","search","byField","extraSortFields","filter","handleDeleteClick","useCallback","handleChangeEditable","prev","handleChangeSelection","event","value","handleChangeSelectMode","handleSortField","_ref3","sortField","DESC_SORT","sort","by","handleChangeTableSearch","_ref4","useEffect","length","parsedIds","map","_ref5","id","variables","ids","_default","exports"],"sources":["../../../../src/resources/ResourceTableContainer/talons/useResourceTableContainer.ts"],"sourcesContent":["import { useCallback, useEffect, useState } from \"react\";\nimport _ from \"lodash\";\nimport { ASC_SORT, DESC_SORT } from \"../../../staticTexts\";\nimport { DataTableSortEvent } from \"primereact/datatable\";\nimport { TableSearchArgument } from \"../../ResourceTableSearch/models/TableSearchArgument\";\n\ninterface UseResourceTableContainer {\n  getQueryMethod?: any;\n  deleteQueryMethod?: any;\n}\n\nconst useResourceTableContainer = ({\n  getQueryMethod,\n  deleteQueryMethod,\n}: UseResourceTableContainer) => {\n  const [order, setOrder] = useState<string>(ASC_SORT);\n  const [selectedValues, setSelectedValues] = useState<[]>([]);\n  const [isSelectable, setSelectable] = useState<boolean>(false);\n  const [isEditable, setEditable] = useState<boolean>(false);\n  const [isDeleteClicked, setDeleteClicked] = useState<boolean>(false);\n\n  const debouncedGetSearchValue = _.debounce(\n    ({ search, byField }: TableSearchArgument) => {\n      getQueryMethod({\n        extraSortFields: {\n          filter: {\n            [byField]: search,\n          },\n        },\n      });\n    },\n    1000\n  );\n\n  // This callback called from another head space into DOM. If try get selected balances into callback body\n  // We get empty arr []. For this I did lifehack with setState, and call deleteBalances into useEffect\n  const handleDeleteClick = useCallback(() => {\n    setDeleteClicked(true);\n  }, [setDeleteClicked]);\n\n  const handleChangeEditable = useCallback(() => {\n    setEditable((prev) => !prev);\n  }, [setEditable]);\n\n  const handleChangeSelection = useCallback(\n    (event: { value: any }) => {\n      setSelectedValues(event.value);\n    },\n    [setSelectedValues]\n  );\n\n  const handleChangeSelectMode = useCallback(() => {\n    setSelectable((prev) => {\n      if (prev) {\n        setSelectedValues([]);\n      }\n\n      return !prev;\n    });\n  }, [setSelectedValues, setSelectable]);\n\n  const handleSortField = useCallback(\n    ({ sortField }: DataTableSortEvent) => {\n      setOrder((prev) => (prev === ASC_SORT ? DESC_SORT : ASC_SORT));\n\n      if (order) {\n        getQueryMethod({\n          extraSortFields: {\n            sort: {\n              by: sortField,\n              order,\n            },\n          },\n        });\n      }\n    },\n    [order, setOrder, getQueryMethod]\n  );\n\n  const handleChangeTableSearch = useCallback(\n    ({ search, byField }: TableSearchArgument) => {\n      debouncedGetSearchValue({ search, byField });\n    },\n    [debouncedGetSearchValue]\n  );\n\n  useEffect(() => {\n    if (isDeleteClicked && selectedValues.length) {\n      const parsedIds = selectedValues.map(({ id }) => id);\n\n      deleteQueryMethod({ variables: { ids: parsedIds } });\n      setDeleteClicked(false);\n      setSelectedValues([]);\n    }\n  }, [isDeleteClicked, selectedValues, deleteQueryMethod]);\n\n  return {\n    handleDeleteClick,\n    handleSortField,\n    handleChangeTableSearch,\n    handleChangeSelection,\n    handleChangeSelectMode,\n    handleChangeEditable,\n    isSelectable,\n    isEditable,\n    selectedValues,\n  };\n};\n\nexport default useResourceTableContainer;\n"],"mappings":"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"}